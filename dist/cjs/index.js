"use strict";var __assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},defaultValues={excludePath:[],dev:!1,hash:!1,domain:null,params:{}};function VantevoAnalytics(e){var t=defaultValues,c=(t=e?__assign(__assign({},defaultValues),e):t).dev,l=t.hash,u=t.excludePath,d=t.params,h=t.domain,p="Ignores hit on localhost.",w="file:"===location.protocol;function f(e){return/^localhost(.*)$|^127(\.[0-9]{1,3}){3}$/i.test(e)}var n,o=function(e,t,n){if(void 0===t&&(t={}),!(window.__phantomas||window._phantom||window.__nightmare||window.navigator.webdriver||window.Cypress)){if(h&&(f(h)||w))return console.warn(p);if(!h&&!c&&(f(location.hostname)||w))return console.warn(p);if(0<u.length)for(var o=window.location.pathname.split("?")[0],a=new RegExp("^"+o.trim().replace(/\*\*/g,".*").replace(/([^\.])\*/g,"$1[^\\s/]*")+"/?$"),i=0;i<u.length;i++)if(a.test(u[i]))return console.warn("exclude page.");var r,o={},s="",s=(h&&(o=__assign(__assign({},d),{domain:h})),l&&(o=__assign(__assign({},o),{hash:!0})),e&&"pageview"==e&&t&&t.path&&(o=__assign(__assign({},o),{path:t.path})),r=o,o=Object.fromEntries(Object.entries(r).filter(function(e){return e[0],null!=e[1]})),s=Object.keys(o).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r[e])}).join("&"),{ts:(new Date).getTime(),url:location.href,t:document.title,ref:document.referrer,w:screen.width,h:screen.height,params:s,e_n:e||"pageview",e_m:t||{}});if(c)return console.log("SUCCESS HIT!",JSON.stringify(s)),n&&n();e=new XMLHttpRequest;e.open("POST","https://api.vantevo.io/event"),e.setRequestHeader("Content-Type","text/plain"),e.send(JSON.stringify(s)),e.onreadystatechange=function(e){4==e.readyState&&n&&n()}}};function a(){!l&&n===location.pathname||(n=location.pathname,o("pageview",{},null))}function i(e){for(var t=e.target,n="auxclick"==e.type&&2==e.which,o="click"==e.type;t&&(void 0===t.tagName||"a"!=t.tagName.toLowerCase()||!t.href);)t=t.parentNode;t&&t.href&&t.host&&t.host!==location.host&&((n||o)&&e("Outbound Link",{url:t.href},null),t.target&&!t.target.match(/^_(self|parent|top)$/i)||e.ctrlKey||e.metaKey||e.shiftKey||!o||(setTimeout(function(){location.href=t.href},150),e.preventDefault()))}return{vantevo:o,enableTracker:function(){var e=window.history.pushState;return e&&(window.history.pushState=function(){e.apply(this,arguments),setTimeout(a,0)},window.addEventListener("popstate",setTimeout(a,0))),document.body?a():window.addEventListener("DOMContentLoaded",a),function(){e&&(window.history.pushState=e,window.removeEventListener("popstate",a))}},enableOutboundLink:function(){return window.addEventListener("click",i),window.addEventListener("auxclick",i),function(){window.removeEventListener("click",i),window.removeEventListener("auxclick",i)}}}}module.exports=VantevoAnalytics;
//# sourceMappingURL=index.js.map
